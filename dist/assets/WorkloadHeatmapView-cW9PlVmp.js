import{d as C,e as H,j as e,f as O}from"./index-DNbqce-j.js";import{r as x}from"./react-vendor-CkwvfVK2.js";import{o as D,j as T}from"./firebase-DdpHYWNd.js";import{s as S}from"./index-B01KZ34F.js";import{a as G}from"./index-BsxtD_7s.js";import{r as R,t as M}from"./index-jHXuI3CI.js";import{f as $}from"./index-CFK5EZMp.js";import{l as A}from"./index-DiNM8yMF.js";import{g as W}from"./index-CSXCcwhn.js";import{T as z}from"./AdminDashboard-BkhDkzix.js";import{A as B}from"./alert-triangle-BUFzzSRW.js";import"./index-CHWv9JIR.js";import"./arrow-left-CeHKlJCF.js";import"./users-BzjIxhpA.js";import"./clock-yngyoSLs.js";import"./book-open-Dw5UZXUq.js";function V(w,b){R(1,arguments);var p=w||{},f=M(p.start),i=M(p.end),u=i.getTime();if(!(f.getTime()<=u))throw new RangeError("Invalid interval");var v=S(f,b),j=S(i,b);v.setHours(15),j.setHours(15),u=j.getTime();for(var h=[],c=v;c.getTime()<=u;)c.setHours(0),h.push(M(c)),c=G(c,1),c.setHours(15);return h}const ne=()=>{const[w,b]=x.useState([]),[p,f]=x.useState([]),[i,u]=x.useState([]),[v,j]=x.useState(!0),[h,c]=x.useState("machine"),[g,k]=x.useState(8),y=S(new Date,{weekStartsOn:1});x.useEffect(()=>{const t=D(T(H,...C.OCCUPANCY),r=>{const l=r.docs.map(s=>({id:s.id,...s.data()}));b(l)}),a=D(T(H,...C.PLANNING),r=>{const l=r.docs.map(o=>({id:o.id,...o.data()}));f(l);const s=[...new Set(l.map(o=>o.machine).filter(Boolean))];u(s.sort()),j(!1)});return()=>{t(),a()}},[]);const d=x.useMemo(()=>V({start:y,end:G(y,g-1)},{weekStartsOn:1}),[y,g]),N=(t,a)=>{const r=W(a),l=a.getFullYear(),s=w.filter(n=>n.machine===t&&n.week===r&&n.year===l).reduce((n,m)=>n+(m.productionHours||0),0),o=p.filter(n=>{if(n.machine!==t||!n.plannedDate)return!1;const m=new Date(n.plannedDate.seconds*1e3),U=W(m),E=m.getFullYear();return U===r&&E===l}).reduce((n,m)=>n+(m.estimatedHours||m.plan/10||0),0);return{capacity:s,demand:o,utilization:s>0?o/s*100:0}},I=t=>t===0?"bg-slate-100 text-slate-400":t<50?"bg-emerald-200 text-emerald-800":t<75?"bg-green-300 text-green-900":t<90?"bg-yellow-300 text-yellow-900":t<110?"bg-orange-400 text-orange-900":"bg-red-500 text-white",P=t=>t<75?e.jsx(O,{size:16,className:"opacity-70"}):t<110?e.jsx(z,{size:16,className:"opacity-70"}):e.jsx(B,{size:16});return v?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6 bg-slate-50 min-h-screen",children:[e.jsx("div",{className:"bg-white rounded-2xl p-6 mb-6 shadow-sm border-2 border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-black text-slate-800",children:["Workload ",e.jsx("span",{className:"text-purple-600",children:"Heatmap"})]}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Visueel overzicht van machine/operator belasting"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>c("machine"),className:`px-3 py-1.5 rounded-lg text-xs font-bold transition-all ${h==="machine"?"bg-purple-500 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"Machines"}),e.jsx("button",{onClick:()=>c("operator"),className:`px-3 py-1.5 rounded-lg text-xs font-bold transition-all ${h==="operator"?"bg-purple-500 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"Operators"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>k(4),className:`px-3 py-1.5 rounded-lg text-xs font-bold transition-all ${g===4?"bg-purple-500 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"4 Weken"}),e.jsx("button",{onClick:()=>k(8),className:`px-3 py-1.5 rounded-lg text-xs font-bold transition-all ${g===8?"bg-purple-500 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"8 Weken"}),e.jsx("button",{onClick:()=>k(12),className:`px-3 py-1.5 rounded-lg text-xs font-bold transition-all ${g===12?"bg-purple-500 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:"12 Weken"})]})]})]})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border-2 border-slate-200 overflow-hidden",children:[e.jsxs("div",{className:"flex border-b-2 border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"w-48 flex-shrink-0 p-4 border-r-2 border-slate-200 font-bold text-sm text-slate-700",children:h==="machine"?"Machine":"Operator"}),e.jsx("div",{className:"flex-1 overflow-x-auto",children:e.jsx("div",{className:"flex",children:d.map((t,a)=>e.jsxs("div",{className:"flex-shrink-0 border-r border-slate-200 p-2 text-center",style:{minWidth:"100px"},children:[e.jsx("div",{className:"text-xs text-slate-500",children:$(t,"'Week' w",{locale:A})}),e.jsx("div",{className:"text-sm font-bold text-slate-800",children:$(t,"dd MMM",{locale:A})})]},a))})})]}),e.jsx("div",{className:"max-h-[600px] overflow-y-auto",children:i.map((t,a)=>e.jsxs("div",{className:`flex border-b border-slate-200 ${a%2===0?"bg-white":"bg-slate-50/50"}`,children:[e.jsx("div",{className:"w-48 flex-shrink-0 p-4 border-r-2 border-slate-200",children:e.jsx("div",{className:"font-bold text-sm text-slate-800",children:t})}),e.jsx("div",{className:"flex-1 overflow-x-auto",children:e.jsx("div",{className:"flex",children:d.map((r,l)=>{const s=N(t,r),o=I(s.utilization),n=P(s.utilization);return e.jsxs("div",{className:`flex-shrink-0 border-r border-slate-200 p-3 group relative transition-all hover:scale-105 cursor-pointer ${o}`,style:{minWidth:"100px",minHeight:"80px"},children:[e.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[n,e.jsxs("div",{className:"text-lg font-black mt-1",children:[Math.round(s.utilization),"%"]}),e.jsxs("div",{className:"text-xs opacity-70",children:[Math.round(s.demand),"h / ",Math.round(s.capacity),"h"]})]}),e.jsxs("div",{className:"hidden group-hover:block absolute top-full left-1/2 transform -translate-x-1/2 mt-2 bg-slate-900 text-white p-3 rounded-lg shadow-xl z-10 whitespace-nowrap text-xs",children:[e.jsxs("div",{className:"font-bold mb-2",children:[t," - Week ",W(r)]}),e.jsxs("div",{children:["Capaciteit: ",Math.round(s.capacity)," uur"]}),e.jsxs("div",{children:["Vraag: ",Math.round(s.demand)," uur"]}),e.jsxs("div",{className:"mt-1 pt-1 border-t border-slate-700",children:["Bezetting: ",Math.round(s.utilization),"%"]})]})]},l)})})})]},t))})]}),e.jsxs("div",{className:"mt-6 bg-white rounded-2xl p-6 shadow-sm border-2 border-slate-200",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-700 mb-3",children:"Bezettingsgraad:"}),e.jsx("div",{className:"flex items-center gap-4",children:[{range:"0%",label:"Geen data",color:"bg-slate-100 text-slate-400"},{range:"< 50%",label:"Lage bezetting",color:"bg-emerald-200 text-emerald-800"},{range:"50-75%",label:"Gezonde bezetting",color:"bg-green-300 text-green-900"},{range:"75-90%",label:"Hoge bezetting",color:"bg-yellow-300 text-yellow-900"},{range:"90-110%",label:"Bijna vol",color:"bg-orange-400 text-orange-900"},{range:"> 110%",label:"Overbelast",color:"bg-red-500 text-white"}].map(t=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-12 h-6 ${t.color} rounded text-xs font-bold flex items-center justify-center`,children:t.range}),e.jsx("span",{className:"text-xs text-slate-600",children:t.label})]},t.range))})]}),e.jsx("div",{className:"mt-6 grid grid-cols-4 gap-4",children:[{label:"Totaal Machines",value:i.length,icon:e.jsx(z,{}),color:"bg-blue-500"},{label:"Gemiddelde Bezetting",value:`${Math.round(i.reduce((t,a)=>{const r=d.reduce((l,s)=>{const o=N(a,s);return l+o.utilization},0)/d.length;return t+r},0)/(i.length||1))}%`,icon:e.jsx(z,{}),color:"bg-purple-500"},{label:"Overbelaste Machines",value:i.filter(t=>d.reduce((r,l)=>{const s=N(t,l);return r+s.utilization},0)/d.length>110).length,icon:e.jsx(B,{}),color:"bg-red-500"},{label:"Gezonde Bezetting",value:i.filter(t=>{const a=d.reduce((r,l)=>{const s=N(t,l);return r+s.utilization},0)/d.length;return a>=50&&a<=90}).length,icon:e.jsx(O,{}),color:"bg-emerald-500"}].map((t,a)=>e.jsxs("div",{className:"bg-white rounded-xl p-4 border-2 border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-bold text-slate-600",children:t.label}),e.jsx("div",{className:`${t.color} text-white p-1.5 rounded-lg`,children:t.icon})]}),e.jsx("div",{className:"text-2xl font-black text-slate-800",children:t.value})]},a))})]})};export{ne as default};
