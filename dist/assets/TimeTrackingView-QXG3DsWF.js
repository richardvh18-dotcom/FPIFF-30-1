import{d as b,e as f,j as e,f as N}from"./index-DNbqce-j.js";import{r as i}from"./react-vendor-CkwvfVK2.js";import{o as v,j as g}from"./firebase-DdpHYWNd.js";import{s as z}from"./index-B01KZ34F.js";import{e as D}from"./index-BAcl2P2b.js";import{i as P}from"./index-BN4zWGSM.js";import{C as A}from"./calendar-C-DwY-3M.js";import{g as I}from"./index-CSXCcwhn.js";import{f as W}from"./index-CFK5EZMp.js";import{C as k}from"./clock-yngyoSLs.js";import{B as _,T as y}from"./trending-down-BdnZJ9c2.js";import{T as p}from"./AdminDashboard-BkhDkzix.js";import{A as G}from"./alert-triangle-BUFzzSRW.js";import"./index-jHXuI3CI.js";import"./arrow-left-CeHKlJCF.js";import"./users-BzjIxhpA.js";import"./book-open-Dw5UZXUq.js";const le=()=>{const[j,w]=i.useState([]),[E,T]=i.useState([]),[S,O]=i.useState(!0),[o,U]=i.useState(new Date),[m,M]=i.useState("all");i.useEffect(()=>{const t=v(g(f,...b.PLANNING),a=>{const c=a.docs.map(l=>({id:l.id,...l.data()}));w(c),O(!1)}),s=v(g(f,...b.OCCUPANCY),a=>{const c=a.docs.map(l=>({id:l.id,...l.data()}));T(c)});return()=>{t(),s()}},[]);const u=i.useMemo(()=>{const t=z(o,{weekStartsOn:1}),s=D(o,{weekStartsOn:1});return j.filter(a=>{if(!a.plannedDate)return!1;const c=new Date(a.plannedDate.seconds*1e3),l=P(c,{start:t,end:s});return m!=="all"&&a.status!==m?!1:l})},[j,o,m]),r=i.useMemo(()=>u.map(t=>{const s=t.estimatedHours||0,a=t.actualHours||0,c=a-s,l=s>0?c/s*100:0;let x="on_track";return Math.abs(l)<10?x="on_track":l>0?x="over":x="under",{...t,planned:s,actual:a,variance:c,variancePercent:l,status:x}}),[u]),n=i.useMemo(()=>{const t=r.reduce((d,h)=>d+h.planned,0),s=r.reduce((d,h)=>d+h.actual,0),a=s-t,c=t>0?a/t*100:0,l=r.filter(d=>d.status==="on_track").length,x=r.filter(d=>d.status==="over").length,V=r.filter(d=>d.status==="under").length;return{totalPlanned:t,totalActual:s,totalVariance:a,avgVariancePercent:c,onTrack:l,over:x,under:V}},[r]),C=t=>t==="on_track"?e.jsx(N,{className:"text-emerald-600",size:20}):t==="over"?e.jsx(p,{className:"text-red-600",size:20}):e.jsx(y,{className:"text-blue-600",size:20});return S?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6 bg-slate-50 min-h-screen",children:[e.jsx("div",{className:"bg-white rounded-2xl p-6 mb-6 shadow-sm border-2 border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-black text-slate-800",children:["Time ",e.jsx("span",{className:"text-blue-600",children:"Tracking"})]}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Vergelijk daadwerkelijke vs geplande tijd per order"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{size:16,className:"text-slate-600"}),e.jsxs("span",{className:"text-sm font-bold text-slate-700",children:["Week ",I(o)," - ",W(o,"yyyy")]})]}),e.jsxs("select",{value:m,onChange:t=>M(t.target.value),className:"px-3 py-1.5 border-2 border-slate-200 rounded-lg text-sm font-bold",children:[e.jsx("option",{value:"all",children:"Alle Status"}),e.jsx("option",{value:"planned",children:"Gepland"}),e.jsx("option",{value:"in_production",children:"In Productie"}),e.jsx("option",{value:"quality_check",children:"Controle"}),e.jsx("option",{value:"ready_to_ship",children:"Verzendklaar"}),e.jsx("option",{value:"shipped",children:"Verzonden"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-4 border-2 border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase",children:"Totaal Gepland"}),e.jsx(k,{className:"text-blue-600",size:20})]}),e.jsxs("div",{className:"text-3xl font-black text-slate-800",children:[Math.round(n.totalPlanned),"h"]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border-2 border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase",children:"Totaal Daadwerkelijk"}),e.jsx(_,{className:"text-purple-600",size:20})]}),e.jsxs("div",{className:"text-3xl font-black text-slate-800",children:[Math.round(n.totalActual),"h"]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border-2 border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase",children:"Variance"}),n.totalVariance>=0?e.jsx(p,{className:"text-red-600",size:20}):e.jsx(y,{className:"text-emerald-600",size:20})]}),e.jsxs("div",{className:`text-3xl font-black ${n.totalVariance>=0?"text-red-600":"text-emerald-600"}`,children:[n.totalVariance>=0?"+":"",Math.round(n.totalVariance),"h"]}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[n.avgVariancePercent>=0?"+":"",Math.round(n.avgVariancePercent),"%"]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border-2 border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase",children:"Status"}),e.jsx(N,{className:"text-emerald-600",size:20})]}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs("div",{className:"text-center flex-1",children:[e.jsx("div",{className:"text-xl font-black text-emerald-600",children:n.onTrack}),e.jsx("div",{className:"text-xs text-slate-500",children:"On Track"})]}),e.jsxs("div",{className:"text-center flex-1",children:[e.jsx("div",{className:"text-xl font-black text-red-600",children:n.over}),e.jsx("div",{className:"text-xs text-slate-500",children:"Over"})]}),e.jsxs("div",{className:"text-center flex-1",children:[e.jsx("div",{className:"text-xl font-black text-blue-600",children:n.under}),e.jsx("div",{className:"text-xs text-slate-500",children:"Under"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border-2 border-slate-200",children:[e.jsx("div",{className:"p-4 border-b-2 border-slate-200 bg-slate-50",children:e.jsxs("h3",{className:"text-sm font-bold text-slate-800",children:["Order Time Analysis (",r.length," orders)"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 border-b-2 border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-600 uppercase",children:"Order"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-600 uppercase",children:"Item"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-bold text-slate-600 uppercase",children:"Machine"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-slate-600 uppercase",children:"Gepland"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-slate-600 uppercase",children:"Daadwerkelijk"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-bold text-slate-600 uppercase",children:"Variance"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-bold text-slate-600 uppercase",children:"Status"})]})}),e.jsx("tbody",{children:r.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-4 py-12 text-center text-slate-400",children:"Geen orders in geselecteerde week"})}):r.map(t=>e.jsxs("tr",{className:"border-b border-slate-100 hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"font-bold text-sm text-slate-800",children:t.orderId||t.item})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"text-sm text-slate-600",children:t.itemCode||t.extraCode})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"text-sm text-slate-600",children:t.machine||"-"})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"text-sm font-bold text-slate-700",children:[Math.round(t.planned),"h"]})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"text-sm font-bold text-slate-700",children:[Math.round(t.actual),"h"]})}),e.jsxs("td",{className:"px-4 py-3 text-right",children:[e.jsxs("div",{className:`text-sm font-bold ${t.variance>=0?"text-red-600":"text-emerald-600"}`,children:[t.variance>=0?"+":"",Math.round(t.variance),"h"]}),e.jsxs("div",{className:`text-xs ${t.variance>=0?"text-red-500":"text-emerald-500"}`,children:[t.variancePercent>=0?"+":"",Math.round(t.variancePercent),"%"]})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex items-center justify-center",children:C(t.status)})})]},t.id))})]})})]}),r.filter(t=>t.status==="over").length>0&&e.jsxs("div",{className:"mt-6 bg-white rounded-2xl shadow-sm border-2 border-red-200 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-red-600 mb-4 flex items-center gap-2",children:[e.jsx(G,{size:20}),"Bottlenecks (Orders die langer duren dan gepland)"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.filter(t=>t.status==="over").sort((t,s)=>s.variance-t.variance).map(t=>e.jsxs("div",{className:"p-4 bg-red-50 border-2 border-red-200 rounded-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-bold text-sm text-slate-800",children:t.orderId||t.item}),e.jsx(p,{className:"text-red-600",size:16})]}),e.jsx("div",{className:"text-xs text-slate-600 mb-2",children:t.itemCode}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-slate-500",children:[Math.round(t.planned),"h ‚Üí ",Math.round(t.actual),"h"]}),e.jsxs("div",{className:"text-sm font-black text-red-600",children:["+",Math.round(t.variance),"h"]})]})]},t.id))})]}),e.jsx("div",{className:"mt-6 bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6 border-2 border-blue-200",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(k,{className:"text-blue-600 flex-shrink-0",size:24}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-2",children:"Time Tracking Analysis"}),e.jsxs("div",{className:"text-sm text-slate-700 space-y-1",children:[e.jsxs("p",{children:["‚úÖ ",e.jsx("strong",{children:"On Track:"})," Variance binnen ¬±10% van gepland"]}),e.jsxs("p",{children:["‚ö†Ô∏è ",e.jsx("strong",{children:"Over:"})," Daadwerkelijke tijd is meer dan 10% hoger dan gepland"]}),e.jsxs("p",{children:["üìâ ",e.jsx("strong",{children:"Under:"})," Daadwerkelijke tijd is meer dan 10% lager dan gepland"]}),e.jsxs("p",{children:["üí° ",e.jsx("strong",{children:"Tip:"})," Gebruik bottleneck analyse om orders te identificeren die extra aandacht nodig hebben"]})]})]})]})})]})};export{le as default};
