import{c as R,u as $,i as U,d as u,e as f,j as e,L as D,M as N,X as I,U as T,f as q,g as L,S as V,h as O}from"./index-DNbqce-j.js";import{r as c}from"./react-vendor-CkwvfVK2.js";import{j as S,q as P,x as _,o as B,l as k,y as E,B as F,D as W,k as X,s as J}from"./firebase-DdpHYWNd.js";import{P as K}from"./plus-fTGSighL.js";import{I as Q}from"./inbox-DmJ6uQ9K.js";import{A as M}from"./archive-BkrLDP6Y.js";import{f as y}from"./index-CFK5EZMp.js";import{T as Y}from"./trash-2-CmT6fCSF.js";import{C as Z}from"./clock-yngyoSLs.js";import{l as ee}from"./index-DiNM8yMF.js";import"./index-jHXuI3CI.js";/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=R("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]),he=()=>{var C;const{user:r}=$(),[a,n]=c.useState([]),[p,b]=c.useState(!0),[o,j]=c.useState("inbox"),[s,d]=c.useState(null),[l,x]=c.useState(!1);c.useEffect(()=>{if(!U("MESSAGES"))return;b(!0);const t=S(f,...u.MESSAGES),i=P(t,_("timestamp","desc")),h=B(i,v=>{const H=v.docs.map(m=>{var A;return{id:m.id,...m.data(),timestamp:((A=m.data().timestamp)==null?void 0:A.toDate())||new Date}}).filter(m=>m.to==="admin"||m.to===(r==null?void 0:r.email)||m.senderId===(r==null?void 0:r.uid));n(H),b(!1)},v=>{console.error("Fout bij laden berichten:",v),b(!1)});return()=>h()},[r]);const w=async t=>{if(!(t.read||t.senderId===(r==null?void 0:r.uid)))try{const i=k(f,...u.MESSAGES,t.id);await E(i,{read:!0})}catch(i){console.error(i)}},g=async t=>{try{const i=k(f,...u.MESSAGES,t.id);await E(i,{archived:!t.archived}),(s==null?void 0:s.id)===t.id&&d(null)}catch(i){console.error(i)}},G=async t=>{if(window.confirm("Dit bericht definitief verwijderen uit de root database?"))try{const i=k(f,...u.MESSAGES,t.id);await F(i),(s==null?void 0:s.id)===t.id&&d(null)}catch(i){console.error(i)}},z=c.useMemo(()=>a.filter(t=>o==="inbox"?!t.archived:o==="archived"?t.archived:!0),[a,o]);return p?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center bg-slate-50 gap-4",children:[e.jsx(D,{className:"animate-spin text-blue-600",size:40}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400 italic",children:"Syncing Hub..."})]}):e.jsxs("div",{className:"flex flex-col md:flex-row h-full bg-slate-50 overflow-hidden animate-in fade-in text-left",children:[e.jsxs("div",{className:`w-full md:w-1/3 xl:w-1/4 border-r border-slate-200 flex flex-col bg-white ${s?"hidden md:flex":"flex"}`,children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 bg-white sticky top-0 z-10 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-black text-slate-900 uppercase italic tracking-tighter",children:"Messages"}),e.jsx("button",{onClick:()=>x(!0),className:"p-2.5 bg-blue-600 text-white rounded-xl shadow-lg hover:bg-blue-700 transition-all active:scale-95",children:e.jsx(K,{size:20,strokeWidth:3})})]}),e.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-2xl",children:[e.jsxs("button",{onClick:()=>{j("inbox"),d(null)},className:`flex-1 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center justify-center gap-2 transition-all ${o==="inbox"?"bg-white text-blue-600 shadow-sm":"text-slate-500"}`,children:[e.jsx(Q,{size:14})," Inbox"]}),e.jsxs("button",{onClick:()=>{j("archived"),d(null)},className:`flex-1 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center justify-center gap-2 transition-all ${o==="archived"?"bg-white text-slate-800 shadow-sm":"text-slate-500"}`,children:[e.jsx(M,{size:14})," Archief"]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:z.length===0?e.jsxs("div",{className:"p-12 text-center flex flex-col items-center text-slate-300 opacity-40",children:[e.jsx(N,{size:48,strokeWidth:1,className:"mb-4"}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest italic",children:"Geen berichten"})]}):z.map(t=>{const i=t.senderId===(r==null?void 0:r.uid),h=!t.read&&!i;return e.jsxs("div",{onClick:()=>{d(t),w(t)},className:`p-6 border-b border-slate-50 cursor-pointer transition-all hover:bg-slate-50 group relative
                    ${h?"bg-blue-50/40":""}
                    ${(s==null?void 0:s.id)===t.id?"bg-blue-50 border-l-4 border-l-blue-600":"border-l-4 border-l-transparent"}
                  `,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:`text-[11px] uppercase italic tracking-tighter truncate max-w-[70%] ${h?"font-black text-slate-900":"font-bold text-slate-500"}`,children:i?`Aan: ${t.toName||t.to}`:t.senderName||t.from}),e.jsx("span",{className:"text-[9px] font-bold text-slate-300 whitespace-nowrap ml-2",children:y(t.timestamp,"HH:mm")})]}),e.jsx("h4",{className:`text-sm truncate mb-1 leading-none ${h?"font-black text-blue-700":"font-bold text-slate-700"}`,children:t.subject||"Geen onderwerp"}),e.jsx("p",{className:"text-xs text-slate-400 line-clamp-1 font-medium italic",children:t.content}),h&&e.jsx("div",{className:"absolute top-6 right-3 w-2 h-2 bg-blue-500 rounded-full shadow-[0_0_8px_rgba(59,130,246,0.6)] animate-pulse"})]},t.id)})})]}),e.jsx("div",{className:`flex-1 flex-col bg-slate-50 transition-all duration-500 ${s?"flex":"hidden md:flex"}`,children:s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-8 bg-white border-b border-slate-200 shadow-sm z-10 text-left",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("button",{onClick:()=>d(null),className:"md:hidden p-2 bg-slate-100 rounded-xl text-slate-400 mr-4",children:e.jsx(I,{size:20})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"bg-slate-900 text-blue-400 px-3 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest italic border border-white/5 shadow-lg",children:"Subject Analysis"}),s.priority==="urgent"&&e.jsx("span",{className:"bg-rose-100 text-rose-600 px-3 py-1 rounded-lg text-[9px] font-black uppercase animate-pulse border border-rose-200",children:"Spoed"})]}),e.jsx("h2",{className:"text-3xl font-black text-slate-900 leading-tight italic tracking-tighter uppercase",children:s.subject})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>g(s),className:"p-3 bg-slate-50 text-slate-400 hover:text-blue-600 rounded-[18px] border border-slate-100 transition-all shadow-sm",title:"Archiveren",children:e.jsx(M,{size:20})}),e.jsx("button",{onClick:()=>G(s),className:"p-3 bg-slate-50 text-slate-400 hover:text-rose-600 rounded-[18px] border border-slate-100 transition-all shadow-sm",title:"Verwijderen",children:e.jsx(Y,{size:20})})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-[25px] border border-slate-100 shadow-inner",children:[e.jsxs("div",{className:"flex items-center gap-4 text-left",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-white flex items-center justify-center text-blue-600 shadow-sm border border-slate-100",children:e.jsx(T,{size:24})}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"font-black text-slate-800 block text-sm uppercase italic leading-none mb-1",children:s.senderName||s.from}),e.jsxs("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:["Gekoppeld ID:"," ",((C=s.senderId)==null?void 0:C.substring(0,8))||"Unknown"]})]})]}),e.jsxs("div",{className:"text-right flex flex-col gap-1 pr-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-slate-400 uppercase tracking-tighter",children:[e.jsx(Z,{size:12,className:"text-blue-500"}),y(s.timestamp,"eeee dd MMMM",{locale:ee})]}),e.jsx("span",{className:"text-[10px] font-bold text-slate-300 font-mono",children:y(s.timestamp,"HH:mm:ss")})]})]})]}),e.jsx("div",{className:"p-10 overflow-y-auto flex-1 text-left",children:e.jsxs("div",{className:"max-w-4xl mx-auto bg-white p-10 rounded-[40px] shadow-sm border border-slate-100 min-h-[300px] relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 -rotate-12",children:e.jsx(N,{size:200})}),e.jsxs("div",{className:"relative z-10 prose prose-slate max-w-none text-slate-700 leading-relaxed text-base italic font-medium whitespace-pre-wrap",children:['"',s.content,'"']}),s.type==="validation_alert"&&e.jsxs("div",{className:"mt-12 p-8 bg-emerald-50 border-2 border-emerald-100 rounded-[30px] flex flex-col md:flex-row items-center gap-8 shadow-lg shadow-emerald-100 animate-in zoom-in",children:[e.jsx("div",{className:"bg-white p-5 rounded-full shadow-xl text-emerald-500 ring-8 ring-emerald-500/10",children:e.jsx(q,{size:40})}),e.jsxs("div",{className:"text-left flex-1",children:[e.jsx("h4",{className:"font-black text-emerald-900 text-xl uppercase italic tracking-tighter",children:"Validatie Nodig"}),e.jsx("p",{className:"text-sm text-emerald-700/80 font-bold uppercase tracking-widest mt-1",children:"Nieuw product wacht op uw oordeel."})]}),e.jsxs("button",{onClick:()=>navigate("/admin/products"),className:"bg-emerald-600 text-white px-10 py-5 rounded-2xl font-black uppercase text-xs tracking-[0.2em] shadow-xl hover:bg-emerald-700 transition-all active:scale-95 flex items-center gap-3 shrink-0",children:["Catalogus Openen ",e.jsx(L,{size:20})]})]})]})}),e.jsxs("div",{className:"p-8 bg-white border-t border-slate-100 flex justify-between items-center shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(V,{size:18,className:"text-emerald-500"}),e.jsx("span",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest",children:"End-to-End Secure Hub Sync"})]}),e.jsxs("button",{onClick:()=>{x(!0)},className:"px-10 py-4 bg-slate-900 text-white rounded-2xl font-black uppercase text-[10px] tracking-[0.2em] shadow-xl hover:bg-blue-600 transition-all flex items-center gap-3 active:scale-95",children:[e.jsx(te,{size:18})," Beantwoorden"]})]})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-300 p-20 text-center opacity-40",children:[e.jsx("div",{className:"bg-white p-10 rounded-[60px] shadow-inner mb-8 border border-slate-200/50",children:e.jsx(N,{size:100,strokeWidth:1,className:"text-slate-200"})}),e.jsx("h3",{className:"text-2xl font-black text-slate-400 uppercase italic tracking-tighter mb-2",children:"Communicatie Hub"}),e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest max-w-xs leading-relaxed text-slate-400",children:"Selecteer een bericht uit de lijst aan de linkerzijde om de inhoud te inspecteren."})]})}),l&&e.jsx(se,{onClose:()=>x(!1),user:r})]})},se=({onClose:r,user:a})=>{const[n,p]=c.useState({to:"admin",subject:"",content:"",priority:"normal"}),[b,o]=c.useState(!1),[j,s]=c.useState([]);c.useEffect(()=>{(async()=>{const x=S(f,...u.USERS),w=await W(x);s(w.docs.map(g=>({id:g.id,...g.data()})))})()},[]);const d=async l=>{if(l.preventDefault(),!(!n.subject||!n.content)){o(!0);try{await X(S(f,...u.MESSAGES),{...n,senderId:a==null?void 0:a.uid,senderName:(a==null?void 0:a.name)||(a==null?void 0:a.displayName)||(a==null?void 0:a.email),from:a==null?void 0:a.email,timestamp:J(),read:!1,archived:!1,type:"user_message"}),r()}catch(x){alert("Verzenden mislukt: "+x.message)}finally{o(!1)}}};return e.jsx("div",{className:"fixed inset-0 z-[200] bg-slate-900/60 backdrop-blur-md flex items-center justify-center p-4 animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white w-full max-w-xl rounded-[40px] shadow-2xl overflow-hidden animate-in zoom-in-95 duration-300 border border-white/10 flex flex-col",children:[e.jsxs("div",{className:"p-8 border-b border-slate-50 flex justify-between items-center bg-slate-50/50",children:[e.jsxs("div",{className:"text-left",children:[e.jsxs("h3",{className:"text-2xl font-black text-slate-900 uppercase italic tracking-tighter leading-none",children:["Nieuw ",e.jsx("span",{className:"text-blue-600",children:"Bericht"})]}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase mt-2 tracking-widest italic",children:"Interne Communicatie"})]}),e.jsx("button",{onClick:r,className:"p-3 hover:bg-white rounded-2xl transition-all shadow-sm group border border-transparent hover:border-slate-100",children:e.jsx(I,{size:20,className:"text-slate-400 group-hover:text-slate-900"})})]}),e.jsxs("form",{onSubmit:d,className:"p-10 space-y-6 text-left",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Ontvanger"}),e.jsxs("select",{className:"w-full p-4 bg-slate-50 border-2 border-slate-100 rounded-2xl font-bold outline-none focus:border-blue-500 text-sm appearance-none cursor-pointer",value:n.to,onChange:l=>p({...n,to:l.target.value}),children:[e.jsx("option",{value:"admin",children:"Administrators (Groep)"}),j.filter(l=>l.email!==(a==null?void 0:a.email)).map(l=>e.jsxs("option",{value:l.email,children:[l.name||l.email," (",l.role,")"]},l.id))]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Prioriteit"}),e.jsxs("select",{className:`w-full p-4 border-2 rounded-2xl font-black outline-none transition-all text-sm appearance-none cursor-pointer ${n.priority==="urgent"?"bg-rose-50 border-rose-100 text-rose-600":"bg-slate-50 border-slate-100 text-slate-700"}`,value:n.priority,onChange:l=>p({...n,priority:l.target.value}),children:[e.jsx("option",{value:"normal",children:"Normaal"}),e.jsx("option",{value:"urgent",children:"Directe Actie (Spoed)"})]})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Onderwerp"}),e.jsx("input",{required:!0,className:"w-full p-4 bg-slate-50 border-2 border-slate-100 rounded-2xl font-bold outline-none focus:border-blue-500 focus:bg-white transition-all text-sm",placeholder:"Waar gaat het over?",value:n.subject,onChange:l=>p({...n,subject:l.target.value})})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1",children:"Inhoud"}),e.jsx("textarea",{required:!0,rows:5,className:"w-full p-6 bg-slate-50 border-2 border-slate-100 rounded-[30px] font-medium outline-none focus:border-blue-500 focus:bg-white transition-all text-sm shadow-inner resize-none italic",placeholder:"Typ hier je bericht voor collega's of admins...",value:n.content,onChange:l=>p({...n,content:l.target.value})})]}),e.jsxs("div",{className:"pt-6 border-t border-slate-100 flex justify-end gap-4",children:[e.jsx("button",{type:"button",onClick:r,className:"px-8 py-4 rounded-2xl font-black text-slate-400 hover:text-slate-600 transition-all text-[10px] uppercase tracking-widest",children:"Annuleren"}),e.jsxs("button",{type:"submit",disabled:b,className:"px-12 py-5 bg-slate-900 text-white rounded-2xl font-black text-[10px] uppercase tracking-[0.2em] shadow-xl hover:bg-blue-600 transition-all active:scale-95 disabled:opacity-50 flex items-center gap-3",children:[b?e.jsx(D,{className:"animate-spin",size:16}):e.jsx(O,{size:16})," ","Versturen naar Hub"]})]})]})]})})};export{he as default};
