import{d as m,e as h,j as e}from"./index-DNbqce-j.js";import{r as p}from"./react-vendor-CkwvfVK2.js";import{o as C,j as u,k as M,B as q,l as F,s as P}from"./firebase-DdpHYWNd.js";import{P as J}from"./plus-fTGSighL.js";import{T as E}from"./trash-2-CmT6fCSF.js";import{C as K}from"./copy-1aL2jCM4.js";import{c as Q}from"./AdminDashboard-BkhDkzix.js";import{a as H}from"./index-CHWv9JIR.js";import"./arrow-left-CeHKlJCF.js";import"./users-BzjIxhpA.js";import"./clock-yngyoSLs.js";import"./book-open-Dw5UZXUq.js";import"./index-jHXuI3CI.js";const pe=()=>{const[j,T]=p.useState([]),[g,$]=p.useState([]),[v,V]=p.useState([]),[c,S]=p.useState(null),[k,N]=p.useState(!1),[l,x]=p.useState({name:"",description:"",changes:[]});p.useEffect(()=>{const s=C(u(h,...m.SCENARIOS),i=>{const d=i.docs.map(b=>({id:b.id,...b.data()}));T(d)}),a=C(u(h,...m.OCCUPANCY),i=>{$(i.docs.map(d=>({id:d.id,...d.data()})))}),o=C(u(h,...m.PLANNING),i=>{V(i.docs.map(d=>({id:d.id,...d.data()})))});return()=>{s(),a(),o()}},[]);const B=s=>{if(!s)return null;let a=[...g],o=[...v];s.changes.forEach(r=>{switch(r.type){case"add_capacity":a=a.map(t=>t.machine===r.machine?{...t,productionHours:(t.productionHours||0)+r.hours}:t);break;case"remove_capacity":a=a.map(t=>t.machine===r.machine?{...t,productionHours:Math.max(0,(t.productionHours||0)-r.hours)}:t);break;case"delay_order":o=o.map(t=>{if(t.id===r.orderId&&t.plannedDate){const y=new Date(t.plannedDate.seconds*1e3),w=H(y,r.days);return{...t,plannedDate:{seconds:w.getTime()/1e3}}}return t});break;case"rush_order":o=o.map(t=>{if(t.id===r.orderId&&t.plannedDate){const y=new Date(t.plannedDate.seconds*1e3),w=H(y,-r.days);return{...t,plannedDate:{seconds:w.getTime()/1e3}}}return t});break;case"change_efficiency":a=a.map(t=>t.machine===r.machine?{...t,efficiency:r.efficiency}:t);break}});const i=a.reduce((r,t)=>r+(t.productionHours||0),0),d=o.reduce((r,t)=>r+(t.estimatedHours||0),0),b=i>0?d/i*100:0,z=i-d,f=g.reduce((r,t)=>r+(t.productionHours||0),0),I=v.reduce((r,t)=>r+(t.estimatedHours||0),0),A=f-I,Y=i-f,O=z-A;return{totalCapacity:i,totalDemand:d,utilization:b,gap:z,baselineCapacity:f,baselineDemand:I,baselineGap:A,capacityChange:Y,gapImprovement:O,isImprovement:O>0}},n=p.useMemo(()=>B(c),[c,g,v]),G=async()=>{if(!l.name){alert("Geef het scenario een naam");return}await M(u(h,...m.SCENARIOS),{...l,createdAt:P(),createdBy:"current_user"}),x({name:"",description:"",changes:[]}),N(!1)},R=async s=>{confirm("Weet je zeker dat je dit scenario wilt verwijderen?")&&(await q(F(h,...m.SCENARIOS,s)),(c==null?void 0:c.id)===s&&S(null))},U=async s=>{await M(u(h,...m.SCENARIOS),{name:`${s.name} (kopie)`,description:s.description,changes:s.changes,createdAt:P(),createdBy:"current_user"})},W=s=>{x({...l,changes:[...l.changes,{id:Date.now(),type:s,machine:"",hours:0,days:0,orderId:"",efficiency:0}]})},L=s=>{x({...l,changes:l.changes.filter(a=>a.id!==s)})},D=(s,a,o)=>{x({...l,changes:l.changes.map(i=>i.id===s?{...i,[a]:o}:i)})},_=s=>({add_capacity:"Capaciteit Toevoegen",remove_capacity:"Capaciteit Verminderen",delay_order:"Order Uitstellen",rush_order:"Order Vervroegen",change_efficiency:"Efficiency Aanpassen"})[s]||s;return e.jsxs("div",{className:"p-6 bg-slate-50 min-h-screen",children:[e.jsx("div",{className:"bg-white rounded-2xl p-6 mb-6 shadow-sm border-2 border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-black text-slate-800",children:["Scenario ",e.jsx("span",{className:"text-purple-600",children:"Planning"})]}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"What-if analyse: simuleer veranderingen voor je ze implementeert"})]}),e.jsxs("button",{onClick:()=>N(!k),className:"flex items-center gap-2 px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-xl font-bold transition-colors",children:[e.jsx(J,{size:16}),"Nieuw Scenario"]})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[k&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border-2 border-purple-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:"Nieuw Scenario"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Scenario naam...",value:l.name,onChange:s=>x({...l,name:s.target.value}),className:"w-full px-3 py-2 border-2 border-slate-200 rounded-lg text-sm"}),e.jsx("textarea",{placeholder:"Beschrijving...",value:l.description,onChange:s=>x({...l,description:s.target.value}),className:"w-full px-3 py-2 border-2 border-slate-200 rounded-lg text-sm",rows:"3"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-700 uppercase mb-2 block",children:"Wijzigingen"}),e.jsx("div",{className:"space-y-2 mb-3",children:l.changes.map(s=>e.jsxs("div",{className:"p-3 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-bold text-slate-600",children:_(s.type)}),e.jsx("button",{onClick:()=>L(s.id),className:"text-red-600 hover:text-red-700",children:e.jsx(E,{size:12})})]}),(s.type==="add_capacity"||s.type==="remove_capacity")&&e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",placeholder:"Machine",value:s.machine,onChange:a=>D(s.id,"machine",a.target.value),className:"px-2 py-1 text-xs border border-slate-200 rounded"}),e.jsx("input",{type:"number",placeholder:"Uren",value:s.hours,onChange:a=>D(s.id,"hours",parseInt(a.target.value)),className:"px-2 py-1 text-xs border border-slate-200 rounded"})]})]},s.id))}),e.jsxs("select",{onChange:s=>{s.target.value&&(W(s.target.value),s.target.value="")},className:"w-full px-3 py-2 border-2 border-slate-200 rounded-lg text-sm",children:[e.jsx("option",{value:"",children:"Wijziging toevoegen..."}),e.jsx("option",{value:"add_capacity",children:"Capaciteit Toevoegen"}),e.jsx("option",{value:"remove_capacity",children:"Capaciteit Verminderen"}),e.jsx("option",{value:"delay_order",children:"Order Uitstellen"}),e.jsx("option",{value:"rush_order",children:"Order Vervroegen"}),e.jsx("option",{value:"change_efficiency",children:"Efficiency Aanpassen"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t-2 border-slate-200",children:[e.jsx("button",{onClick:G,className:"px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg font-bold transition-colors",children:"Scenario Opslaan"}),e.jsx("button",{onClick:()=>N(!1),className:"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg font-bold transition-colors",children:"Annuleren"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border-2 border-slate-200",children:[e.jsx("div",{className:"p-4 border-b-2 border-slate-200 bg-slate-50",children:e.jsxs("h3",{className:"text-sm font-bold text-slate-800",children:["Scenarios (",j.length,")"]})}),e.jsx("div",{className:"p-4 space-y-2 max-h-[600px] overflow-y-auto",children:j.length===0?e.jsx("div",{className:"text-center py-12 text-slate-400 text-sm",children:"Nog geen scenarios"}):j.map(s=>e.jsxs("div",{onClick:()=>S(s),className:`p-4 rounded-xl border-2 cursor-pointer transition-all ${(c==null?void 0:c.id)===s.id?"border-purple-500 bg-purple-50":"border-slate-200 bg-white hover:border-slate-300"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-sm text-slate-800",children:s.name}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:s.description})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:a=>{a.stopPropagation(),U(s)},className:"p-1 hover:bg-blue-100 rounded-lg transition-colors",children:e.jsx(K,{className:"text-blue-600",size:14})}),e.jsx("button",{onClick:a=>{a.stopPropagation(),R(s.id)},className:"p-1 hover:bg-red-100 rounded-lg transition-colors",children:e.jsx(E,{className:"text-red-600",size:14})})]})]}),e.jsxs("div",{className:"text-xs text-slate-500",children:[s.changes.length," wijziging(en)"]})]},s.id))})]})]}),e.jsx("div",{className:"col-span-2",children:c&&n?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border-2 border-slate-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:"Impact Analyse"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-slate-500 uppercase mb-1",children:"Capaciteit"}),e.jsxs("div",{className:"text-2xl font-black text-slate-800",children:[Math.round(n.totalCapacity),"h"]}),e.jsxs("div",{className:`text-xs font-bold mt-1 ${n.capacityChange>=0?"text-emerald-600":"text-red-600"}`,children:[n.capacityChange>=0?"+":"",Math.round(n.capacityChange),"h"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-slate-500 uppercase mb-1",children:"Utilization"}),e.jsxs("div",{className:"text-2xl font-black text-slate-800",children:[Math.round(n.utilization),"%"]}),e.jsx("div",{className:`text-xs font-bold mt-1 ${n.utilization<90?"text-emerald-600":"text-red-600"}`,children:n.utilization<90?"Gezond":"Overbelast"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-slate-500 uppercase mb-1",children:"Gap"}),e.jsxs("div",{className:`text-2xl font-black ${n.gap>=0?"text-emerald-600":"text-red-600"}`,children:[n.gap>=0?"+":"",Math.round(n.gap),"h"]}),e.jsx("div",{className:`text-xs font-bold mt-1 ${n.isImprovement?"text-emerald-600":"text-red-600"}`,children:n.isImprovement?"✓ Verbetering":"✗ Verslechtering"})]})]}),e.jsxs("div",{className:"pt-6 border-t-2 border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase",children:"Baseline"}),e.jsxs("span",{className:"text-sm font-bold text-slate-700",children:[Math.round(n.baselineCapacity),"h capaciteit /",Math.round(n.baselineGap),"h gap"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs font-bold text-purple-600 uppercase",children:"Na Scenario"}),e.jsxs("span",{className:"text-sm font-bold text-purple-700",children:[Math.round(n.totalCapacity),"h capaciteit /",Math.round(n.gap),"h gap"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border-2 border-slate-200 p-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:["Wijzigingen (",c.changes.length,")"]}),e.jsx("div",{className:"space-y-3",children:c.changes.map((s,a)=>e.jsxs("div",{className:"p-4 bg-purple-50 border-2 border-purple-200 rounded-xl",children:[e.jsx("div",{className:"font-bold text-sm text-slate-800 mb-2",children:_(s.type)}),e.jsxs("div",{className:"text-xs text-slate-600",children:[s.machine&&`Machine: ${s.machine}`,s.hours&&` | ${s.hours}h`,s.days&&` | ${s.days} dagen`]})]},a))})]})]}):e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border-2 border-slate-200 p-12 text-center",children:[e.jsx(Q,{className:"mx-auto mb-4 text-slate-300",size:48}),e.jsx("div",{className:"text-slate-400",children:"Selecteer een scenario om de impact te analyseren"})]})})]})]})};export{pe as default};
