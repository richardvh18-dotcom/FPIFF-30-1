import{i as L,d as _,e as k,j as e,L as S,S as H,l as I,E as U,n as M,z as C,W as X,C as Y,X as W,A as V,D as q}from"./index-DNbqce-j.js";import{r as o}from"./react-vendor-CkwvfVK2.js";import{l as z,o as J,t as K,s as Q}from"./firebase-DdpHYWNd.js";import{S as Z,P as ee}from"./AdminDashboard-BkhDkzix.js";import{B as te}from"./bug-BnPpfO84.js";import{P as se}from"./plus-fTGSighL.js";import{C as A}from"./cpu-BQwTkJut.js";import{C as ae}from"./clock-yngyoSLs.js";import{T as D}from"./trash-2-CmT6fCSF.js";import{A as re}from"./activity-BBrgQQV7.js";import{T as ie}from"./timer-Dsj0FPXu.js";import"./arrow-left-CeHKlJCF.js";import"./users-BzjIxhpA.js";import"./book-open-Dw5UZXUq.js";const Ne=()=>{const[m,l]=o.useState({departments:[]}),[g,f]=o.useState(!0),[j,N]=o.useState(!1),[x,c]=o.useState(null),[d,v]=o.useState({}),[u,P]=o.useState(!1),p=_.FACTORY_CONFIG;o.useEffect(()=>{if(!L("FACTORY_CONFIG")){console.error("Critical: FACTORY_CONFIG path is not defined.");return}const t=z(k,...p),r=J(t,s=>{if(s.exists()){const a=s.data();l({...a,departments:Array.isArray(a.departments)?a.departments:[]})}else l({departments:[]});f(!1)},s=>{console.error("Firestore Sync Error:",s),c({type:"error",msg:`Access Denied: ${s.code}`}),f(!1)});return()=>r()},[]);const T=t=>{v(r=>({...r,[t]:!r[t]}))},w=()=>{const t=`dept_${Date.now()}`,r={id:t,name:"New Production Unit",slug:"new-unit",country:"Nederland",stations:[],shifts:[{id:"DAG",label:"Dagdienst",start:"07:15",end:"16:00"}],isActive:!0};l(s=>({...s,departments:[...s.departments||[],r]})),v(s=>({...s,[t]:!0}))},y=(t,r,s)=>{l(a=>({...a,departments:a.departments.map(i=>i.id===t?{...i,[r]:s}:i)}))},F=t=>{window.confirm("Delete this entire production department and all linked stations?")&&l(r=>({...r,departments:r.departments.filter(s=>s.id!==t)}))},E=t=>{l(r=>({...r,departments:r.departments.map(s=>{if(s.id===t){const a={id:`st_${Date.now()}`,name:"STATION-X",type:"machine"};return{...s,stations:[...s.stations||[],a]}}return s})}))},O=(t,r,s)=>{l(a=>({...a,departments:a.departments.map(i=>i.id===t?{...i,stations:i.stations.map(n=>n.id===r?{...n,name:s.toUpperCase()}:n)}:i)}))},$=(t,r)=>{l(s=>({...s,departments:s.departments.map(a=>a.id===t?{...a,stations:(a.stations||[]).filter(i=>i.id!==r)}:a)}))},G=t=>{l(r=>({...r,departments:r.departments.map(s=>{if(s.id===t){const a={id:`sh_${Date.now()}`,label:"New Shift",start:"06:00",end:"14:15"};return{...s,shifts:[...s.shifts||[],a]}}return s})}))},h=(t,r,s,a)=>{l(i=>({...i,departments:i.departments.map(n=>n.id===t?{...n,shifts:n.shifts.map(b=>b.id===r?{...b,[s]:a}:b)}:n)}))},R=(t,r)=>{l(s=>({...s,departments:s.departments.map(a=>a.id===t?{...a,shifts:a.shifts.filter(i=>i.id!==r)}:a)}))},B=async()=>{N(!0),c(null);try{const t=z(k,...p);await K(t,{...m,lastUpdated:Q(),version:"5.0"},{merge:!0}),c({type:"success",msg:"Factory logic published to root!"}),setTimeout(()=>c(null),4e3)}catch(t){console.error("Save Error:",t),c({type:"error",msg:`Failed: ${t.code}`})}finally{N(!1)}};return g?e.jsx("div",{className:"flex h-full items-center justify-center bg-slate-50",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(S,{className:"animate-spin text-blue-600 mx-auto",size:48}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400 italic",children:"Synchronizing Factory Blueprint..."})]})}):e.jsx("div",{className:"h-full bg-slate-50 overflow-y-auto custom-scrollbar text-left pb-40",children:e.jsxs("div",{className:"max-w-6xl mx-auto p-6 space-y-8 animate-in fade-in",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6 bg-white p-8 rounded-[40px] shadow-sm border border-slate-200 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5 rotate-12",children:e.jsx(Z,{size:120})}),e.jsxs("div",{className:"text-left relative z-10",children:[e.jsxs("h1",{className:"text-3xl font-black text-slate-900 uppercase italic tracking-tighter leading-none",children:["Factory ",e.jsx("span",{className:"text-blue-600",children:"Structure"})]}),e.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[e.jsxs("span",{className:"flex items-center gap-1.5 text-[9px] font-black text-emerald-600 bg-emerald-50 px-2.5 py-0.5 rounded border border-emerald-100 uppercase italic",children:[e.jsx(H,{size:10})," Root Synchronized"]}),e.jsxs("p",{className:"text-[9px] font-mono text-slate-400 uppercase tracking-widest",children:["Target: /",p.join("/")]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 relative z-10",children:[x&&e.jsxs("div",{className:`px-4 py-2 rounded-xl text-[10px] font-black uppercase flex items-center gap-2 animate-in slide-in-from-right-2 ${x.type==="success"?"bg-emerald-50 text-emerald-600":"bg-rose-50 text-rose-600"}`,children:[x.type==="success"?e.jsx(I,{size:14}):e.jsx(U,{size:14}),x.msg]}),e.jsx("button",{onClick:()=>P(!u),className:`p-4 rounded-2xl transition-all ${u?"bg-blue-600 text-white shadow-lg":"bg-slate-100 text-slate-400 hover:bg-slate-200"}`,children:e.jsx(te,{size:18})}),e.jsxs("button",{onClick:w,className:"px-6 py-4 bg-slate-900 text-white rounded-2xl font-black text-[10px] uppercase tracking-widest flex items-center gap-2 shadow-xl hover:bg-slate-800 transition-all active:scale-95",children:[e.jsx(se,{size:16})," Add Unit"]}),e.jsxs("button",{onClick:B,disabled:j,className:"px-10 py-4 bg-blue-600 text-white rounded-2xl font-black text-[10px] uppercase tracking-[0.2em] flex items-center gap-3 shadow-xl active:scale-95 disabled:opacity-50 hover:bg-blue-700 transition-all",children:[j?e.jsx(S,{className:"animate-spin",size:18}):e.jsx(M,{size:18})," ","Publiceren"]})]})]}),u&&e.jsxs("div",{className:"bg-slate-900 rounded-[30px] p-6 text-white font-mono text-[10px] space-y-2 animate-in zoom-in-95 border-b-4 border-blue-500 shadow-2xl",children:[e.jsx("p",{className:"text-blue-400 font-black mb-2",children:"--- CORE PATH DEBUGGER ---"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500",children:"Firestore Path:"})," /",p.join("/")]}),e.jsxs("p",{children:[e.jsx("span",{className:"text-slate-500",children:"Node Status:"})," ",g?"Syncing...":"Live"]})]})]}),e.jsx("div",{className:"space-y-6",children:(m.departments||[]).length===0?e.jsxs("div",{className:"bg-white border-4 border-dashed border-slate-100 rounded-[45px] p-24 text-center opacity-60",children:[e.jsx(C,{size:64,className:"mx-auto text-slate-200 mb-6"}),e.jsx("h3",{className:"text-xl font-black uppercase italic text-slate-800",children:"Empty Factory Layout"}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-2 mb-8",children:"Begin creating production units"}),e.jsx("button",{onClick:w,className:"px-8 py-4 bg-blue-600 text-white rounded-2xl font-black uppercase text-[10px] tracking-widest shadow-lg",children:"+ Add First Department"})]}):m.departments.map(t=>{var r;return e.jsxs("div",{className:`bg-white rounded-[45px] border-2 transition-all duration-300 shadow-sm overflow-hidden ${d[t.id]?"border-blue-500 ring-8 ring-blue-500/5 shadow-2xl":"border-slate-100 hover:border-slate-200"}`,children:[e.jsxs("div",{className:`p-8 flex justify-between items-center cursor-pointer transition-colors ${d[t.id]?"bg-blue-50/20":"hover:bg-slate-50/50"}`,onClick:()=>T(t.id),children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:`p-5 rounded-[22px] shadow-md transition-all ${d[t.id]?"bg-blue-600 text-white scale-110":"bg-slate-100 text-slate-400"}`,children:e.jsx(C,{size:28})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h4",{className:"text-2xl font-black uppercase italic tracking-tighter text-slate-900",children:t.name}),e.jsxs("div",{className:"flex items-center gap-4 mt-1.5",children:[e.jsxs("span",{className:"text-[9px] font-black text-blue-500 uppercase tracking-widest flex items-center gap-1.5",children:[e.jsx(X,{size:12})," ",t.country]}),e.jsxs("span",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-1.5 border-l border-slate-200 pl-4",children:[e.jsx(A,{size:12})," ",(t.stations||[]).length," ","Stations"]}),e.jsxs("span",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-1.5 border-l border-slate-200 pl-4",children:[e.jsx(ae,{size:12})," ",(t.shifts||[]).length," ","Ploegen"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),F(t.id)},className:"p-3 text-slate-300 hover:text-rose-500 transition-colors",children:e.jsx(D,{size:20})}),e.jsx("div",{className:`p-2 rounded-lg transition-transform duration-500 ${d[t.id]?"rotate-180 bg-blue-100 text-blue-600":"bg-slate-50 text-slate-300"}`,children:e.jsx(Y,{size:24})})]})]}),d[t.id]&&e.jsxs("div",{className:"p-10 border-t border-slate-50 bg-white space-y-12 animate-in slide-in-from-top-4 duration-500 text-left",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-10",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] ml-2 italic",children:"Production Unit Name"}),e.jsx("input",{type:"text",value:t.name,onChange:s=>y(t.id,"name",s.target.value),className:"w-full p-5 bg-slate-50 border-2 border-slate-100 rounded-[22px] font-black uppercase text-sm outline-none focus:border-blue-500 transition-all shadow-inner"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] ml-2 italic",children:"Operation Hub Location"}),e.jsxs("select",{value:t.country,onChange:s=>y(t.id,"country",s.target.value),className:"w-full p-5 bg-slate-50 border-2 border-slate-100 rounded-[22px] font-black uppercase text-sm outline-none focus:border-blue-500 transition-all cursor-pointer shadow-inner",children:[e.jsx("option",{value:"Nederland",children:"Nederland (FPi Hardenberg)"}),e.jsx("option",{value:"Dubai",children:"Dubai (DXB Plant)"}),e.jsx("option",{value:"EGT",children:"Egypte (EGT Plant)"})]})]})]}),e.jsxs("div",{className:"space-y-6 pt-10 border-t border-slate-50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"text-left",children:[e.jsxs("h5",{className:"text-[11px] font-black text-blue-600 uppercase tracking-[0.3em] flex items-center gap-2 italic leading-none",children:[e.jsx(re,{size:18})," Integrated Workstations"]}),e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase mt-2",children:"Active terminals linked to this unit"})]}),e.jsx("button",{onClick:()=>E(t.id),className:"px-5 py-3 bg-blue-600 text-white rounded-xl font-black text-[10px] uppercase tracking-widest shadow-md hover:bg-blue-700 transition-all active:scale-95",children:"+ Add Station"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4",children:[(t.stations||[]).map(s=>e.jsxs("div",{className:"relative group/st",children:[e.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-300 group-hover/st:text-blue-500 transition-colors pointer-events-none",children:e.jsx(A,{size:16})}),e.jsx("input",{type:"text",value:s.name,onChange:a=>O(t.id,s.id,a.target.value),className:"w-full pl-12 pr-10 py-5 bg-slate-50 border-2 border-slate-100 rounded-[20px] font-black text-xs outline-none focus:border-blue-500 focus:bg-white transition-all shadow-sm uppercase tracking-tighter"}),e.jsx("button",{onClick:()=>$(t.id,s.id),className:"absolute right-3 top-1/2 -translate-y-1/2 p-2 text-slate-200 hover:text-rose-500 transition-colors opacity-0 group-hover/st:opacity-100",children:e.jsx(D,{size:16})})]},s.id)),((r=t.stations)==null?void 0:r.length)===0&&e.jsx("div",{className:"col-span-full py-10 bg-slate-50/50 rounded-[30px] border-2 border-dashed border-slate-100 text-center text-[10px] font-black uppercase text-slate-300 italic tracking-widest",children:"No stations configured"})]})]}),e.jsxs("div",{className:"space-y-6 pt-10 border-t border-slate-50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"text-left",children:[e.jsxs("h5",{className:"text-[11px] font-black text-orange-600 uppercase tracking-[0.3em] flex items-center gap-2 italic leading-none",children:[e.jsx(ie,{size:18})," Shift Management"]}),e.jsx("p",{className:"text-[9px] font-bold text-slate-400 uppercase mt-2",children:"Operational time slots for occupancy"})]}),e.jsx("button",{onClick:()=>G(t.id),className:"px-5 py-3 bg-slate-900 text-white rounded-xl font-black text-[10px] uppercase tracking-widest shadow-md hover:bg-slate-800 transition-all active:scale-95",children:"+ Add Shift"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:(t.shifts||[]).map(s=>e.jsxs("div",{className:"p-6 bg-slate-50 rounded-[35px] border-2 border-slate-100 space-y-4 relative group/sh shadow-inner hover:border-orange-200 transition-all",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("input",{type:"text",value:s.label,onChange:a=>h(t.id,s.id,"label",a.target.value),className:"bg-transparent font-black uppercase text-xs text-slate-800 outline-none border-b border-transparent focus:border-orange-300 transition-all w-2/3"}),e.jsx("button",{onClick:()=>R(t.id,s.id),className:"p-2 text-slate-300 hover:text-rose-500 opacity-0 group-hover/sh:opacity-100 transition-all",children:e.jsx(W,{size:16})})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-white p-3 rounded-2xl border border-slate-100 shadow-sm",children:[e.jsx("input",{type:"time",value:s.start,onChange:a=>h(t.id,s.id,"start",a.target.value),className:"flex-1 bg-transparent text-xs font-black text-blue-600 outline-none"}),e.jsx(V,{size:14,className:"text-slate-300"}),e.jsx("input",{type:"time",value:s.end,onChange:a=>h(t.id,s.id,"end",a.target.value),className:"flex-1 bg-transparent text-xs font-black text-blue-600 outline-none"})]})]},s.id))})]})]})]},t.id)})}),e.jsxs("div",{className:"p-10 bg-slate-900 rounded-[50px] text-white/50 text-[10px] font-black uppercase tracking-[0.3em] flex flex-col md:flex-row items-center gap-8 relative overflow-hidden border border-white/5",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5 rotate-12",children:e.jsx(q,{size:150})}),e.jsx("div",{className:"p-4 bg-blue-600 rounded-[22px] shadow-lg text-white",children:e.jsx(ee,{size:28})}),e.jsxs("div",{className:"text-left flex-1 relative z-10 leading-relaxed max-w-3xl",children:["Changes to the factory structure are globally enforced. Adding or removing stations will immediately update all",e.jsxs("span",{className:"text-blue-400 italic",children:[" ","Station Selection Hubs"]})," ","and"," ",e.jsx("span",{className:"text-emerald-400 italic",children:"Personnel Assignment"})," ","modules across the MES network."]})]})]})})};export{Ne as default};
